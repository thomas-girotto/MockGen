<#@ template language="C#" #>
<#@ assembly name="System.Core" #>
<#@ import namespace="System.Linq" #>
<#@ import namespace="System.Text" #>
<#@ import namespace="System.Collections.Generic" #>
using System;
using MockGen.Setup;
using <#=Descriptor.TypeToMockOriginalNamespace#>;

namespace MockGen
{
    internal class <#=Descriptor.TypeToMock#>MockBuilder
    {
<# foreach (var method in Descriptor.Methods) {#>
        private readonly <#=method.MethodSetupWithTypedParameters#> <#=method.NameCamelCase#>Setup = new <#=method.MethodSetupWithTypedParameters#>();
<#}#>

<# foreach (var method in Descriptor.Methods) {#>
        public <#=method.IMethodSetupWithTypedParameters#> <#=method.Name#>(<#=method.ParametersDeclarationWithArg#>)
        {
<# if (method.Parameters.Count > 0) {#>
            return <#=method.NameCamelCase#>Setup.ForParameter(<#=method.CallForParameterMethod#>);
<#} else { #>
            return <#=method.NameCamelCase#>Setup;
<#}#>
        }

<#}#>
        public <#=Descriptor.TypeToMock#> Build()
        {
<# foreach (var method in Descriptor.Methods) {#>
            <#=method.NameCamelCase#>Setup.SetupDone();
<# } #>

            return new <#=Descriptor.TypeToMock#>Mock(<#=Descriptor.MockCtorParameters#>);
        }
    }
}